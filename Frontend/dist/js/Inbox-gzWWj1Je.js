import{j as e}from"./ui-vendor-D_YnDhxq.js";import{a as s}from"./react-vendor-B1YRfcvv.js";import{a,b as t,c as r}from"./index-BpOdPcLd.js";import"./redux-vendor-Cc4mDNFq.js";import"./utils-vendor-B4hhIH4d.js";const l=()=>{const[l,n]=s.useState([]),[o,d]=s.useState(null);s.useEffect(()=>{(async()=>{try{const e=await fetch("/api/query/all",{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}}),s=await e.json();if(s.success){n(s.queries);const e=s.queries.filter(e=>"unviewed"===e.status).length;setUnreadCount(e)}}catch(e){}})()},[]);return e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md mt-4 w-full max-w-7xl",children:[e.jsxs("div",{className:"bg-white shadow-lg rounded-lg p-6 mt-4",children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsx("h2",{className:"text-2xl font-semibold",children:"Super Admin Query"})}),e.jsx("div",{className:"overflow-auto max-w-full",children:e.jsx("div",{className:"min-w-[800px]",children:e.jsxs("table",{className:"w-full table-fixed border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-primary text-white text-left",children:[e.jsx("th",{className:"px-4 py-2 w-[150px]",children:"Name"}),e.jsx("th",{className:"px-4 py-2 w-[200px]",children:"Subject"}),e.jsx("th",{className:"px-4 py-2 w-[300px]",children:"Message"}),e.jsx("th",{className:"px-4 py-2 w-[300px]",children:"Response"}),e.jsx("th",{className:"px-4 py-2 w-[150px]",children:"Actions"})]})}),e.jsx("tbody",{children:l.map(s=>e.jsxs("tr",{className:"border-b hover:bg-gray-100 "+("responded"===s.status?"bg-green-100":""),children:[e.jsx("td",{className:"px-4 py-2 break-words",children:s.name}),e.jsx("td",{className:"px-4 py-2 break-words",children:s.subject}),e.jsx("td",{className:"px-4 py-2 break-words",children:s.message}),e.jsx("td",{className:"px-4 py-2 break-words",children:s.response||"No response yet"}),e.jsxs("td",{className:"px-4 py-2 flex gap-2",children:[e.jsx("button",{className:"hover:text-green-500",onClick:()=>(async e=>{try{(await fetch(`/api/query/view/${e}`,{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}})).ok&&n(l.map(s=>s._id===e?{...s,status:"viewed"}:s))}catch(s){}})(s._id),children:e.jsx(a,{className:"unviewed"!==s.status?"text-green-500":"text-gray-500"})}),e.jsx("button",{className:"text-red-500",onClick:()=>(async e=>{try{(await fetch(`/api/query/delete/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}})).ok&&n(l.filter(s=>s._id!==e))}catch(s){}})(s._id),children:e.jsx(t,{})}),e.jsx("button",{className:"text-blue-500",onClick:()=>d(s),children:e.jsx(r,{})})]})]},s._id))})]})})})]}),o&&e.jsxs("div",{className:"bg-white p-6 shadow-lg rounded-lg mt-4",children:[e.jsxs("h3",{className:"text-xl font-semibold mb-4",children:["Reply to ",o.name]}),e.jsx("textarea",{value:o.response||"",className:"w-full p-3 border border-gray-300 rounded-lg mb-4",placeholder:"Type your reply here",onChange:e=>d({...o,response:e.target.value})}),e.jsx("button",{onClick:()=>(async(e,s)=>{try{const a=await fetch(`/api/query/respond/${e}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("authToken")}`},body:JSON.stringify({response:s})}),t=await a.json();a.ok&&(n(s=>s.map(s=>s._id===e?{...s,response:t.query.response,status:"responded"}:s)),d(null))}catch(a){}})(o._id,o.response),className:"bg-primary text-white px-4 py-2 rounded-lg",children:"Send Reply"})]})]})};export{l as default};

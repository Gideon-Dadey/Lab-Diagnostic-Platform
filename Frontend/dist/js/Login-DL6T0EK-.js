import{j as e,c as s}from"./ui-vendor-D_YnDhxq.js";import{u as a,a as t,L as r}from"./react-vendor-B1YRfcvv.js";import{c as i,a as l,u as o}from"./forms-vendor-CyXfoBQa.js";import{O as n,P as d,F as c,a as m,Q as x,N as u,S as h}from"./index-BpOdPcLd.js";import{I as p}from"./index-EIlo7iDb.js";import{o as g}from"./yup-ANMf5mc7.js";import{u as b,e as w}from"./redux-vendor-Cc4mDNFq.js";import"./utils-vendor-B4hhIH4d.js";const j=i().shape({email:l().email("Enter a valid email").required("Email is required"),password:l().required("Password is required")}),v=({password:s})=>{const a=t.useMemo(()=>{if(!s)return 0;let e=0;return s.length>=8&&e++,/[A-Z]/.test(s)&&e++,/[0-9]/.test(s)&&e++,/[^A-Za-z0-9]/.test(s)&&e++,e},[s]);return e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${["bg-rose-400","bg-rose-400","bg-amber-400","bg-emerald-400","bg-emerald-600"][a]}`,style:{width:a/4*100+"%"},"aria-hidden":"true"})}),e.jsx("p",{className:"text-xs mt-1 text-gray-500",children:["Too weak","Weak","Okay","Good","Strong"][a]})]})},f=()=>{const i=b(),l=a(),{user:f}=w(e=>e.auth||{}),[y,N]=t.useState(!1),[S,k]=t.useState(()=>!!localStorage.getItem("authToken")),[C,I]=t.useState(!1),[L,A]=t.useState(!1),{register:P,handleSubmit:T,setError:E,watch:F,formState:{errors:q}}=o({resolver:g(j),mode:"onTouched",reValidateMode:"onChange"}),G=F("password","");t.useEffect(()=>{var e,s;const a=window.location.pathname;if(f&&("/login"===a||"/"===a)){const a=null==(s=null==(e=f.role)?void 0:e.toLowerCase())?void 0:s.replace(/\s+/g,"");l("superadmin"===a?"/admin/super/overview":"labadmin"===a?"/labadmin/lab/overview":"/user",{replace:!0})}},[f,l]);return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-b from-gray-50 to-white p-6",children:e.jsxs("div",{className:"w-full max-w-6xl grid grid-cols-1 md:grid-cols-12 gap-6 items-stretch",style:{minHeight:700},children:[e.jsxs("div",{className:"hidden md:block md:col-span-6 relative rounded-3xl overflow-hidden shadow-xl h-full",children:[e.jsx("img",{src:"/images/Login-BiboPUtT.jpg",alt:"Laboratory hero",className:"absolute inset-0 w-full h-full object-cover brightness-90"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-indigo-700/60 via-transparent to-emerald-600/30 mix-blend-multiply"}),e.jsxs("div",{className:"relative z-10 p-10 h-full flex flex-col justify-between text-white",children:[e.jsxs("div",{children:[e.jsx("div",{className:"inline-flex items-center gap-3 bg-white/10 px-3 py-1 rounded-full mb-6",children:e.jsx("span",{className:"text-xs font-semibold",children:"Pragma Health"})}),e.jsx("h1",{className:"text-3xl md:text-4xl font-extrabold leading-tight drop-shadow",children:"Secure access to diagnostics and insights"}),e.jsx("p",{className:"mt-4 text-sm md:text-base max-w-lg",children:"Access your reports, manage lab integrations, and collaborate with clinicians — all in one secure platform."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 bg-white/10 rounded-lg border border-white/10",children:[e.jsx("h4",{className:"text-sm font-semibold",children:"Trusted Labs"}),e.jsx("p",{className:"text-xs mt-1",children:"500+ accredited partners"})]}),e.jsxs("div",{className:"p-4 bg-white/10 rounded-lg border border-white/10",children:[e.jsx("h4",{className:"text-sm font-semibold",children:"Fast Results"}),e.jsx("p",{className:"text-xs mt-1",children:"Most tests within 24–48 hours"})]})]})]})]}),e.jsxs("div",{className:"col-span-1 md:col-span-6 bg-white rounded-3xl shadow-lg p-8 md:p-10 flex flex-col justify-center h-full",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-extrabold text-gray-900",children:"Welcome back"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Sign in to your account to continue"})]}),e.jsx("div",{className:"text-xs text-gray-400",children:"Secure · HIPAA-aware"})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-6",children:[e.jsxs("button",{type:"button",className:"flex items-center justify-center gap-2 px-3 py-2 rounded-lg border border-gray-200 hover:shadow-sm transition text-sm",onClick:()=>s("Google sign-in placeholder"),"aria-label":"Sign in with Google",children:[e.jsx(n,{className:"text-red-500"})," Sign in with Google"]}),e.jsxs("button",{type:"button",className:"flex items-center justify-center gap-2 px-3 py-2 rounded-lg border border-gray-200 hover:shadow-sm transition text-sm",onClick:()=>s("Apple sign-in placeholder"),"aria-label":"Sign in with Apple",children:[e.jsx(d,{})," Sign in with Apple"]})]}),e.jsxs("div",{className:"relative mb-6",children:[e.jsx("div",{className:"absolute inset-0 flex items-center","aria-hidden":"true",children:e.jsx("div",{className:"w-full border-t border-gray-200"})}),e.jsx("div",{className:"relative flex justify-center text-xs",children:e.jsx("span",{className:"bg-white px-2 text-gray-500",children:"or continue with email"})})]}),e.jsxs("form",{className:"space-y-4",onSubmit:T(async e=>{var a,t,r,o,n,d;N(!0);try{const r=await u("/api/auth/login",e),o=r.data.data;if(null==o?void 0:o.forcePasswordChange)return s.error("You must change your password before continuing."),void l(`/reset-password-force/${o._id}`);S?localStorage.setItem("authToken",r.data.token):sessionStorage.setItem("authToken",r.data.token),localStorage.setItem("userId",o._id),i(h(o)),s.success(r.data.message||"Login successful!");const n=null==(t=null==(a=o.role)?void 0:a.toLowerCase())?void 0:t.replace(/\s+/g,"");l("superadmin"===n?"/admin/super/overview":"labadmin"===n?"/labadmin/lab/labdashboard":"/user")}catch(c){const e=(null==(o=null==(r=null==c?void 0:c.response)?void 0:r.data)?void 0:o.message)||"Login failed";if(s.error(e),e.toLowerCase().includes("invalid")&&(E("email",{message:"Invalid email or password"}),E("password",{message:"Invalid email or password"})),null==(d=null==(n=null==c?void 0:c.response)?void 0:n.data)?void 0:d.errors){const e=c.response.data.errors;for(const s in e)E(s,{message:e[s]})}}finally{N(!1)}}),noValidate:!0,children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"email",name:"email",type:"email",placeholder:" ",autoComplete:"email","aria-invalid":!!q.email,"aria-describedby":q.email?"err-email":void 0,className:`peer w-full px-4 py-3 rounded-lg border ${q.email?"border-rose-500":"border-gray-200"} bg-white focus:outline-none focus:ring-2 focus:ring-indigo-300 text-sm`,...P("email")}),e.jsx("label",{htmlFor:"email",className:"absolute left-4 -top-2.5 px-1 text-xs bg-white text-gray-500 peer-placeholder-shown:top-3 peer-placeholder-shown:text-sm peer-placeholder-shown:text-gray-400 transition-all pointer-events-none",children:"Email"}),q.email&&e.jsx("p",{id:"err-email",className:"text-rose-600 text-xs mt-1",children:q.email.message})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"password",name:"password",type:C?"text":"password",placeholder:" ",autoComplete:"current-password","aria-invalid":!!q.password,"aria-describedby":q.password?"err-password":void 0,className:`peer w-full px-4 py-3 rounded-lg border ${q.password?"border-rose-500":"border-gray-200"} bg-white focus:outline-none focus:ring-2 focus:ring-indigo-300 text-sm`,...P("password")}),e.jsx("label",{htmlFor:"password",className:"absolute left-4 -top-2.5 px-1 text-xs bg-white text-gray-500 peer-placeholder-shown:top-3 peer-placeholder-shown:text-sm peer-placeholder-shown:text-gray-400 transition-all pointer-events-none",children:"Password"}),e.jsx("button",{type:"button",onClick:()=>I(e=>!e),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500","aria-label":C?"Hide password":"Show password",children:C?e.jsx(c,{}):e.jsx(m,{})}),q.password&&e.jsx("p",{id:"err-password",className:"text-rose-600 text-xs mt-1",children:q.password.message}),e.jsx(v,{password:G})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("label",{className:"inline-flex items-center gap-2 text-gray-600",children:[e.jsx("input",{type:"checkbox",checked:S,onChange:e=>k(e.target.checked),className:"accent-indigo-600"}),"Remember me"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{type:"button",onClick:async()=>{A(!0);const e=(document.querySelector('input[name="email"]')||{}).value;if(!e)return s.error("Enter your email to receive a magic link."),void A(!1);try{await u("/api/auth/magic-link",{email:e}),s.success("Magic link sent. Check your inbox.")}catch(a){s.error("Failed to send magic link.")}finally{A(!1)}},className:"text-indigo-600 hover:underline text-sm",disabled:L,children:L?"Sending...":"Send magic link"}),e.jsx(r,{to:"/user/forgot-password",className:"text-sm text-gray-600 hover:underline",children:"Forgot password?"})]})]}),e.jsx("div",{children:e.jsxs("button",{type:"submit",disabled:y,className:"w-full inline-flex items-center justify-center gap-3 px-4 py-3 rounded-lg text-white font-semibold transition "+(y?"bg-indigo-400 cursor-wait":"bg-indigo-600 hover:bg-indigo-700"),"aria-live":"polite",children:[y?e.jsx(p,{className:"animate-spin"}):e.jsx(x,{}),e.jsx("span",{children:y?"Signing in...":"Sign in"})]})})]}),e.jsxs("div",{className:"mt-6 text-center text-sm text-gray-500",children:["New here?"," ",e.jsx(r,{to:"/register",className:"text-indigo-600 font-medium hover:underline",children:"Create an account"})]})]})]})})};export{f as default};

import{G as e,j as s}from"./ui-vendor-D_YnDhxq.js";import{a,L as t}from"./react-vendor-B1YRfcvv.js";import{a as r}from"./utils-vendor-B4hhIH4d.js";import{w as l,ag as i,a8 as n,ah as c,aa as d,$ as o,a2 as x,ai as m,aj as h,s as u,ak as g,al as p}from"./index-BpOdPcLd.js";import"./redux-vendor-Cc4mDNFq.js";function b(s){return e({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M294.1 256L167 129c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.3 34 0L345 239c9.1 9.1 9.3 23.7.7 33.1L201.1 417c-4.7 4.7-10.9 7-17 7s-12.3-2.3-17-7c-9.4-9.4-9.4-24.6 0-33.9l127-127.1z"},child:[]}]})(s)}function f(...e){return e.filter(Boolean).join(" ")}function j({rating:e,size:a=14}){const t=[];for(let r=1;r<=5;r++)e>=r?t.push(s.jsx(u,{className:"text-yellow-400",style:{width:a,height:a}},r)):e>=r-.5?t.push(s.jsx(g,{className:"text-yellow-400",style:{width:a,height:a}},r)):t.push(s.jsx(p,{className:"text-yellow-400",style:{width:a,height:a}},r));return s.jsx("span",{className:"flex items-center gap-0.5","aria-hidden":!0,children:t})}function y(){return s.jsxs("div",{className:"bg-white rounded-2xl shadow-sm overflow-hidden animate-pulse",children:[s.jsx("div",{className:"h-40 bg-gray-200"}),s.jsxs("div",{className:"p-4 space-y-3",children:[s.jsx("div",{className:"h-5 bg-gray-200 rounded w-3/4"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"}),s.jsx("div",{className:"h-3 bg-gray-200 rounded w-2/3"}),s.jsx("div",{className:"h-9 bg-gray-200 rounded mt-2"})]})]})}function N(){const[e,t]=a.useState([]),[d,o]=a.useState(""),x=function(e,s=300){const[t,r]=a.useState(e);return a.useEffect(()=>{const a=setTimeout(()=>r(e),s);return()=>clearTimeout(a)},[e,s]),t}(d,300),[m,h]=a.useState(""),[u,g]=a.useState(0),[p,b]=a.useState(!1),[j,N]=a.useState(!0),[w,C]=a.useState(null),[S,k]=a.useState(!1),A=a.useRef(!0);a.useEffect(()=>{A.current=!0;const e=new AbortController;return async function(){var s;N(!0),C(null);try{const a=await r.get("/api/labs/public",{signal:e.signal});if(!A.current)return;t(Array.isArray(null==(s=a.data)?void 0:s.labs)?a.data.labs:[])}catch(a){if(r.isCancel(a))return;if(!A.current)return;C("Unable to load labs. Please try again.")}finally{if(!A.current)return;N(!1)}}(),()=>{A.current=!1,e.abort()}},[]);const L=a.useMemo(()=>{const s=(x||"").trim().toLowerCase();let a=e.filter(e=>{if(p&&!e.isCertified)return!1;if((e.rating||0)<u)return!1;if(!s)return!0;return[e.name,e.location,e.description,Array.isArray(e.specialties)?e.specialties.join(" "):"",Array.isArray(e.tests)?e.tests.join(" "):""].filter(Boolean).join(" ").toLowerCase().includes(s)});return"rating"===m?a=a.sort((e,s)=>(s.rating||0)-(e.rating||0)):"price_low"===m?a=a.sort((e,s)=>(e.price||0)-(s.price||0)):"price_high"===m?a=a.sort((e,s)=>(s.price||0)-(e.price||0)):"nearest"===m&&(a=a.sort((e,s)=>(e.distance||1/0)-(s.distance||1/0))),a},[e,x,m,u,p]);return s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10",children:[s.jsxs("header",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-3xl shadow-lg px-8 py-10 mb-8 border border-gray-200 text-center",children:[s.jsx("h1",{className:"text-3xl md:text-4xl font-extrabold text-gray-900 mb-2",children:"Find Premium Diagnostic Labs"}),s.jsx("p",{className:"text-gray-600 max-w-2xl mx-auto",children:"Discover accredited labs with modern equipment, fast turnaround, and verified patient reviews."})]}),s.jsxs("section",{className:"flex flex-col md:flex-row md:items-center gap-4 mb-6",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx("label",{htmlFor:"lab-search",className:"sr-only",children:"Search labs"}),s.jsx("input",{id:"lab-search",type:"search",inputMode:"search",placeholder:"Search labs by name, location, test, or specialty...",value:d,onChange:e=>o(e.target.value),className:"w-full px-4 md:px-5 py-3 rounded-xl border border-gray-300 bg-white text-gray-800 shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500","aria-label":"Search labs"}),s.jsx(l,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-400","aria-hidden":!0})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("button",{type:"button",onClick:()=>k(e=>!e),"aria-expanded":S,className:"flex items-center gap-2 bg-white px-4 py-2 rounded-xl border border-gray-300 hover:shadow transition",children:[s.jsx(i,{className:"text-gray-600"}),s.jsx("span",{className:"hidden md:inline",children:"Filters"}),s.jsx(n,{className:f("transition-transform",S?"rotate-180":"")})]}),s.jsx("div",{className:"flex items-center gap-2 bg-white px-3 py-2 rounded-xl border border-gray-300",children:s.jsxs("select",{"aria-label":"Sort labs",className:"bg-transparent text-gray-700 focus:outline-none",value:m,onChange:e=>h(e.target.value),children:[s.jsx("option",{value:"",children:"Sort: Recommended"}),s.jsx("option",{value:"rating",children:"Highest rating"}),s.jsx("option",{value:"price_low",children:"Price: Low to High"}),s.jsx("option",{value:"price_high",children:"Price: High to Low"}),s.jsx("option",{value:"nearest",children:"Nearest"})]})})]})]}),S&&s.jsx("section",{className:"mb-6 bg-white border border-gray-200 rounded-xl p-4 shadow-sm",children:s.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("label",{className:"text-sm text-gray-700 font-medium",children:"Min rating"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"range",min:0,max:5,step:.5,value:u,onChange:e=>g(Number(e.target.value)),"aria-label":"Minimum rating"}),s.jsx("span",{className:"text-sm text-gray-600",children:u.toFixed(1)})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("label",{className:"text-sm text-gray-700 font-medium",children:"Certified"}),s.jsx("input",{type:"checkbox",checked:p,onChange:e=>b(e.target.checked),"aria-label":"Certified labs only",className:"h-4 w-4"})]}),s.jsx("div",{className:"ml-auto flex items-center gap-3",children:s.jsxs("button",{type:"button",onClick:()=>{o(""),h(""),g(0),b(!1)},className:"inline-flex items-center gap-2 text-sm px-3 py-2 rounded-md border border-gray-300 bg-white hover:bg-gray-50",children:[s.jsx(c,{})," Reset"]})})]})}),w&&s.jsxs("div",{className:"mb-6 p-4 rounded-lg bg-red-50 border border-red-200 text-red-700 flex items-center justify-between",children:[s.jsx("div",{children:w}),s.jsx("div",{className:"flex items-center gap-2",children:s.jsx("button",{onClick:()=>{N(!0),C(null),r.get("/api/labs/public").then(e=>{var s;return t(Array.isArray(null==(s=e.data)?void 0:s.labs)?e.data.labs:[])}).catch(e=>{C("Retry failed. Please check your connection.")}).finally(()=>N(!1))},className:"px-3 py-1.5 bg-red-600 text-white rounded-md text-sm",children:"Retry"})})]}),j?s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:Array.from({length:8}).map((e,a)=>s.jsx(y,{},a))}):s.jsx("main",{children:0===L.length?s.jsxs("div",{className:"text-center py-20",children:[s.jsx("p",{className:"text-gray-600 mb-4",children:"No labs match your search or filter criteria."}),s.jsx("button",{onClick:()=>{o(""),h(""),g(0),b(!1)},className:"text-blue-600 hover:text-blue-800 font-medium",children:"Clear filters"})]}):s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:L.map(e=>s.jsx(v,{lab:e},e._id||e.id))})})]})}function v({lab:e}){const[r,l]=a.useState(!1),{_id:i,id:n,name:c,location:u,rating:g,image:p,description:y,hours:N,phone:v,sameDayResults:w,specialties:C,distance:S,price:k,isCertified:A}=e,L=i||n,F=y||"Premium diagnostic lab with advanced testing facilities and trusted reporting.",P=Array.isArray(C)?C:C?[C]:[];return s.jsxs("article",{className:"bg-white rounded-2xl shadow-sm hover:shadow-lg transition overflow-hidden flex flex-col h-full border",children:[s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:p||"/default-lab.jpg",alt:c,className:"w-full h-44 object-cover",loading:"lazy",onError:e=>{e.currentTarget.src="/default-lab.jpg"}}),A&&s.jsx("span",{className:"absolute top-3 left-3 bg-green-600 text-white text-xs font-semibold px-3 py-1 rounded-full",children:"Certified"}),void 0!==k&&s.jsxs("span",{className:"absolute top-3 right-3 bg-white/90 text-sm text-gray-800 font-medium px-2.5 py-1 rounded-md",children:["from $",Number(k).toFixed(0)]})]}),s.jsxs("div",{className:"p-4 flex flex-col flex-1",children:[s.jsxs("div",{className:"flex items-start justify-between gap-3",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 truncate",children:c}),s.jsxs("div",{className:"text-sm text-gray-500 flex items-center gap-2 mt-1",children:[s.jsx(d,{className:"text-primary","aria-hidden":!0}),s.jsx("span",{className:"truncate",children:u||"Address not available"})]})]}),s.jsxs("div",{className:"ml-2 flex flex-col items-end",children:[s.jsxs("div",{className:"inline-flex items-center gap-2 bg-gray-50 px-2 py-1 rounded-full",children:[s.jsx("span",{className:"text-sm font-semibold text-gray-800",children:g?g.toFixed(1):"New"}),g?s.jsx(j,{rating:g,size:12}):s.jsx("span",{className:"text-xs text-gray-400",children:"â€”"})]}),s.jsx("button",{"aria-label":"Save lab",title:"Save lab",className:"mt-2 text-red-500 hover:text-red-600",children:s.jsx(o,{})})]})]}),s.jsx("p",{className:"text-sm text-gray-600 mt-3 line-clamp-2",children:F}),s.jsxs("div",{className:"flex gap-3 mt-3 text-sm text-gray-600",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(x,{className:"text-primary"}),s.jsx("span",{children:N||"24/7"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(m,{className:"text-primary"}),s.jsx("a",{href:v?`tel:${v}`:"#",className:"text-gray-700 hover:underline",children:v||"Contact"})]})]}),r&&s.jsxs("div",{className:"mt-3 text-sm text-gray-600 space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(h,{className:"text-primary"}),s.jsxs("span",{children:["Same day results: ",s.jsx("strong",{className:"ml-1 text-gray-800",children:w?"Yes":"No"})]})]}),s.jsx("div",{className:"flex flex-wrap gap-2",children:P.length>0?P.slice(0,6).map((e,a)=>s.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 rounded-full text-xs",children:e},a)):s.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 rounded-full text-xs",children:"General"})}),"number"==typeof S&&s.jsxs("div",{className:"text-sm text-gray-700",children:[s.jsx("span",{className:"mr-1",children:"ðŸ“"}),s.jsxs("span",{children:[S.toFixed(1)," km away"]})]})]}),s.jsxs("div",{className:"mt-auto pt-4",children:[s.jsxs("div",{className:"flex gap-3",children:[s.jsx(t,{to:`/labs/${L}/testpackage`,className:"flex-1 text-center bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded-lg text-sm font-medium transition","aria-label":`View tests and packages for ${c}`,children:"View Tests & Packages"}),s.jsx(t,{to:`/labs/${L}/details`,className:"flex-1 text-center border border-blue-600 text-blue-600 hover:bg-blue-600 hover:text-white px-3 py-2 rounded-lg text-sm font-medium transition","aria-label":`View details for ${c}`,children:"Lab Details"})]}),s.jsxs("button",{onClick:()=>l(e=>!e),className:"w-full mt-3 flex items-center justify-center gap-2 text-sm text-blue-600 hover:underline","aria-expanded":r,children:[r?"Show less":"View more details",s.jsx(b,{className:f("transition-transform",r?"rotate-90":"")})]})]})]})]})}export{N as default};

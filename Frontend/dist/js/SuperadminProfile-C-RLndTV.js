import{j as e}from"./ui-vendor-D_YnDhxq.js";import{a}from"./react-vendor-B1YRfcvv.js";import{u as r}from"./index-BIodPqjN.js";import{d as s,e as t,F as o,a as l}from"./index-BpOdPcLd.js";import"./redux-vendor-Cc4mDNFq.js";import"./utils-vendor-B4hhIH4d.js";const i=()=>{const[i,n]=a.useState({firstName:"",lastName:"",email:"",image:""}),[d,c]=a.useState(null),[m,u]=a.useState(!1),[p,g]=a.useState(!1),[h,x]=a.useState(null),[f,b]=a.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[y,w]=a.useState(!1),[j,N]=a.useState(!1),[v,P]=a.useState(!1),[k,C]=a.useState(""),[S,z]=a.useState("profile");a.useEffect(()=>{F()},[]);const F=async()=>{try{g(!0);const e=await fetch("/api/superadmin/get-settings",{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}}),a=await e.json();e.ok?(n({firstName:a.firstName||"",lastName:a.lastName||"",email:a.email||"",image:a.image||""}),c(a.image||"")):r.error(a.message||"Failed to fetch profile")}catch(e){r.error("Something went wrong fetching profile")}finally{g(!1)}};return p?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):e.jsxs("div",{className:"max-w-4xl mx-auto bg-white p-8 shadow-lg rounded-lg mt-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-8 text-center",children:"Profile Settings"}),e.jsxs("div",{className:"flex justify-center space-x-4 mb-8 border-b pb-4",children:[e.jsx("button",{onClick:()=>z("profile"),className:"px-6 py-2 rounded-md font-semibold transition-all "+("profile"===S?"bg-primary text-white shadow-md":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:"Profile Information"}),e.jsx("button",{onClick:()=>z("password"),className:"px-6 py-2 rounded-md font-semibold transition-all "+("password"===S?"bg-primary text-white shadow-md":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:"Change Password"})]}),"profile"===S&&e.jsx("div",{className:"space-y-8",children:m?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsxs("div",{className:"relative group",children:[d?e.jsx("img",{src:d,alt:"Profile Preview",className:"w-40 h-40 rounded-full object-cover shadow-lg border-4 border-primary"}):e.jsx("div",{className:"w-40 h-40 rounded-full bg-gray-200 flex items-center justify-center shadow-lg border-4 border-primary",children:e.jsx(s,{className:"w-20 h-20 text-gray-400"})}),e.jsxs("label",{className:"absolute bottom-0 right-0 bg-primary text-white p-2 rounded-full cursor-pointer shadow-lg hover:bg-primary-dark transition-all group-hover:scale-110",children:[e.jsx(t,{className:"w-5 h-5"}),e.jsx("input",{type:"file",accept:"image/*",onChange:e=>{const a=e.target.files[0];if(a){if(a.size>5242880)return void r.error("Image size should be less than 5MB");x(a),c(URL.createObjectURL(a))}},className:"hidden"})]})]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Click the camera icon to change profile picture"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"First Name"}),e.jsx("input",{type:"text",value:i.firstName,onChange:e=>n(a=>({...a,firstName:e.target.value})),className:"w-full border border-gray-300 p-3 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Last Name"}),e.jsx("input",{type:"text",value:i.lastName,onChange:e=>n(a=>({...a,lastName:e.target.value})),className:"w-full border border-gray-300 p-3 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Email"}),e.jsx("input",{type:"email",value:i.email,onChange:e=>n(a=>({...a,email:e.target.value})),className:"w-full border border-gray-300 p-3 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-4 mt-8",children:[e.jsx("button",{onClick:()=>{u(!1),F()},className:"px-6 py-3 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition-all",children:"Cancel"}),e.jsx("button",{onClick:async()=>{try{g(!0);const e=new FormData;e.append("firstName",i.firstName),e.append("lastName",i.lastName),e.append("email",i.email),h&&e.append("image",h);const a=await fetch("/api/superadmin/update-settings",{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`},body:e}),s=await a.json();a.ok?(r.success("Profile updated successfully"),u(!1),x(null),F()):r.error(s.message||"Failed to update profile")}catch(e){r.error("Something went wrong updating profile")}finally{g(!1)}},className:"px-6 py-3 bg-primary text-white rounded-md hover:bg-primary-dark transition-all shadow-md",children:"Save Changes"})]})]}):e.jsxs("div",{className:"flex flex-col items-center space-y-6",children:[e.jsx("div",{className:"relative",children:d?e.jsx("img",{src:d,alt:"Profile",className:"w-40 h-40 rounded-full object-cover shadow-lg border-4 border-primary"}):e.jsx("div",{className:"w-40 h-40 rounded-full bg-gray-200 flex items-center justify-center shadow-lg border-4 border-primary",children:e.jsx(s,{className:"w-20 h-20 text-gray-400"})})}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsxs("h2",{className:"text-2xl font-semibold text-gray-800",children:[i.firstName," ",i.lastName]}),e.jsx("p",{className:"text-gray-500",children:i.email}),e.jsx("button",{onClick:()=>u(!0),className:"mt-4 bg-primary text-white px-8 py-3 rounded-md hover:bg-primary-dark transition-all shadow-md",children:"Edit Profile"})]})]})}),"password"===S&&e.jsxs("div",{className:"max-w-md mx-auto space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Current Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:y?"text":"password",value:f.currentPassword,onChange:e=>b(a=>({...a,currentPassword:e.target.value})),className:"w-full border border-gray-300 p-3 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent"}),e.jsx("button",{type:"button",onClick:()=>w(!y),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700",children:y?e.jsx(o,{}):e.jsx(l,{})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:j?"text":"password",value:f.newPassword,onChange:e=>b(a=>({...a,newPassword:e.target.value})),className:"w-full border border-gray-300 p-3 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent"}),e.jsx("button",{type:"button",onClick:()=>N(!j),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700",children:j?e.jsx(o,{}):e.jsx(l,{})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Confirm New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:v?"text":"password",value:f.confirmPassword,onChange:e=>b(a=>({...a,confirmPassword:e.target.value})),className:"w-full border border-gray-300 p-3 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent"}),e.jsx("button",{type:"button",onClick:()=>P(!v),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700",children:v?e.jsx(o,{}):e.jsx(l,{})})]})]}),k&&e.jsx("div",{className:"text-red-500 text-sm mt-2",children:k}),e.jsx("button",{onClick:async()=>{if(f.newPassword!==f.confirmPassword)return void C("New passwords do not match");if(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/.test(f.newPassword))try{g(!0),C("");const e=await fetch("/api/superadmin/password",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("authToken")}`},body:JSON.stringify({currentPassword:f.currentPassword,newPassword:f.newPassword})}),a=await e.json();e.ok?(r.success("Password changed successfully"),b({currentPassword:"",newPassword:"",confirmPassword:""})):r.error(a.message||"Failed to change password")}catch(e){r.error("Something went wrong changing password")}finally{g(!1)}else C("Password must be at least 8 characters long and include uppercase, lowercase, number, and special character")},className:"w-full bg-primary text-white px-6 py-3 rounded-md hover:bg-primary-dark transition-all shadow-md mt-8",children:"Update Password"})]})]})};export{i as default};

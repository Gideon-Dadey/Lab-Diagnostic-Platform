import{j as e,V as a}from"./ui-vendor-D_YnDhxq.js";import{a as s}from"./react-vendor-B1YRfcvv.js";const t=({toggleAddLab:a,addLab:t,editLab:l,editLabDetails:d})=>{const[i,n]=s.useState({name:"",address:"",location:"",description:"",isActive:!0,assignedAdmin:"",image:null,type:""}),[r,c]=s.useState(null),[m,o]=s.useState([]),[p,x]=s.useState("");s.useEffect(()=>{(async()=>{try{const e=await fetch("/api/superadmin/labadmins",{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}}),a=await e.json();o(a.labAdmins||[])}catch(e){x("Failed to fetch lab admins. Please try again.")}})()},[]),s.useEffect(()=>{l&&(n({name:l.name||"",address:l.address||"",location:l.location||"",description:l.description||"",isActive:l.isActive??!0,assignedAdmin:l.labAdmin||"",type:l.type||"",image:null}),c(l.image||null))},[l]);const u=e=>{const{name:a,value:s,type:t,checked:l,files:d}=e.target;if("file"===t){const e=d[0];if(e&&!e.type.startsWith("image/"))return void x("Please upload a valid image file.");n(a=>({...a,image:e})),c(URL.createObjectURL(e)),x("")}else n(e=>({...e,[a]:"checkbox"===t?l:s}))};return e.jsxs("div",{className:"rounded-lg p-6 mt-6",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:l?"Edit Lab":"Add New Lab"}),p&&e.jsx("p",{className:"text-red-500",children:p}),e.jsxs("form",{onSubmit:e=>{if(e.preventDefault(),!(i.name&&i.address&&i.location&&i.description&&i.type&&i.assignedAdmin))return void x("Please fill all the required fields.");const s=new FormData;s.append("name",i.name),s.append("address",i.address),s.append("location",i.location),s.append("description",i.description),s.append("isActive",i.isActive?"true":"false"),s.append("assignedAdmin",i.assignedAdmin),s.append("type",i.type),s.append("uploadFolder","labs"),i.image&&s.append("image",i.image),l?d({...l,...i}):t(s),a()},encType:"multipart/form-data",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Lab Name"}),e.jsx("input",{type:"text",name:"name",value:i.name,onChange:u,className:"w-full px-3 py-2 border rounded-md",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Address"}),e.jsx("input",{type:"text",name:"address",value:i.address,onChange:u,className:"w-full px-3 py-2 border rounded-md",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Location"}),e.jsx("input",{type:"text",name:"location",value:i.location,onChange:u,className:"w-full px-3 py-2 border rounded-md",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Description"}),e.jsx("textarea",{name:"description",value:i.description,onChange:u,className:"w-full px-3 py-2 border rounded-md",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Lab Type"}),e.jsxs("select",{name:"type",value:i.type||"",onChange:u,className:"w-full px-3 py-2 border rounded-md",required:!0,children:[e.jsx("option",{value:"",children:"Select Type"}),e.jsx("option",{value:"Lab",children:"Lab"}),e.jsx("option",{value:"Hospital",children:"Hospital"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Assign Lab Admin"}),e.jsxs("select",{name:"assignedAdmin",value:i.assignedAdmin,onChange:u,className:"w-full px-3 py-2 border rounded-md",required:!0,children:[e.jsx("option",{value:"",children:"Select Lab Admin"}),m.map(a=>e.jsxs("option",{value:a._id,disabled:a.isAssigned,className:a.isAssigned?"text-gray-400 italic":"",children:[a.firstName," ",a.lastName," (",a.email,")",a.labId?" (Already Assigned)":""]},a._id))]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Lab Image"}),e.jsx("input",{type:"file",accept:"image/*",name:"image",onChange:u,className:"w-full"}),r&&e.jsx("img",{src:r,alt:"Preview",className:"mt-2 h-32 rounded border"})]}),e.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"isActive",checked:i.isActive,onChange:u,className:"w-4 h-4"}),e.jsx("label",{className:"text-sm text-gray-700",children:"Mark as Active"})]}),e.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[e.jsx("button",{type:"button",className:"bg-gray-500 text-white px-4 py-2 rounded-md",onClick:a,children:"Cancel"}),e.jsx("button",{type:"submit",className:"bg-primary text-white px-4 py-2 rounded-md",children:l?"Save Changes":"Add Lab"})]})]})]})},l=()=>{const[l,d]=s.useState([]),[i,n]=s.useState(!1),[r,c]=s.useState(null),m=async()=>{try{const e=await fetch("/api/labs/all",{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}}),a=await e.json();a.success&&Array.isArray(a.labs)&&d(a.labs)}catch(e){}};s.useEffect(()=>{m()},[]);const o=()=>{n(!i),c(null)};return e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md mt-4 w-full max-w-7xl",children:[e.jsxs("div",{className:"bg-white shadow-lg rounded-lg p-6 mt-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4 md:mb-0",children:"Labs"}),!i&&!r&&e.jsx("button",{onClick:o,className:"bg-primary text-white px-4 py-2 rounded w-full md:w-auto",children:"Add New Lab"})]}),e.jsx("p",{className:"text-black mb-4 text-center md:text-left",children:"Manage all your existing labs or add a new one"})]}),i||r?e.jsx("div",{className:"mt-6 p-4 bg-white shadow-lg rounded-lg",children:e.jsx(t,{toggleAddLab:o,addLab:async e=>{try{const s=await fetch("/api/labs/create",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`},body:e}),t=await s.json();s.ok?(a.success("Lab created successfully"),n(!1),m()):a.error(t.message||"Failed to create lab")}catch(s){a.error("Server error while creating lab")}},editLab:r,editLabDetails:async e=>{try{const s=new FormData;s.append("name",e.name),s.append("address",e.address),s.append("location",e.location),s.append("description",e.description),s.append("isActive",e.isActive),s.append("assignedAdmin",e.assignedAdmin),s.append("type",e.type),s.append("uploadFolder","labs"),e.image&&s.append("image",e.image);const t=await fetch(`/api/labs/${e._id}`,{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`},body:s}),l=await t.json();t.ok?(a.success("Lab updated successfully"),m(),n(!1),c(null)):a.error(l.message||"Failed to update lab")}catch(s){a.error("Error updating lab")}}})}):e.jsx("div",{className:"bg-white shadow-lg rounded-lg p-6 mt-4",children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-1 lg:grid-cols-3 gap-6",children:l.map(s=>e.jsxs("div",{className:"bg-white shadow-md rounded-lg p-6",children:[e.jsx("img",{src:s.image,alt:s.name,className:"w-full h-40 object-cover rounded-md mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-center md:text-left",children:s.name}),e.jsx("p",{className:"text-gray-600 mt-2 text-center md:text-left",children:s.address}),e.jsx("p",{className:"text-gray-500 text-sm text-center md:text-left",children:s.location}),s.labAdmin&&e.jsxs("p",{className:"text-sm text-gray-600 text-center md:text-left",children:["Assigned Admin: ",s.labAdmin.firstName," ",s.labAdmin.lastName]}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mt-4 space-y-2 md:space-y-0",children:[e.jsx("button",{className:"text-sm px-4 py-2 rounded-lg w-full md:w-auto "+(s.isActive?"bg-primary text-white":"bg-gray-300 text-gray-700"),children:s.isActive?"Active":"Inactive"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{className:"bg-primary text-white px-3 py-1 rounded-lg",onClick:()=>{c(s),n(!0)},children:"Edit"}),e.jsx("button",{className:"bg-primary text-white px-3 py-1 rounded-lg",onClick:()=>(async e=>{try{const s=await fetch(`/api/labs/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}}),t=await s.json();s.ok?(a.success("Lab deleted successfully"),m()):a.error(t.message||"Failed to delete lab")}catch(s){a.error("Error deleting lab")}})(s._id),children:"Delete"})]})]})]},s._id))})})]})};export{l as default};

import{j as e}from"./ui-vendor-D_YnDhxq.js";import{a as s}from"./react-vendor-B1YRfcvv.js";const t=()=>{const[t,a]=s.useState([]),[r,l]=s.useState(!0),n=async()=>{l(!0);try{const e=await fetch("/api/orders/user",{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}}),s=await e.json();a((null==s?void 0:s.orders)||[])}catch(e){}finally{l(!1)}};s.useEffect(()=>{n()},[]);const d=e=>{switch(e){case"Completed":return"bg-green-200 text-green-800";case"Cancelled":return"bg-red-200 text-red-800";case"Progress":return"bg-blue-200 text-blue-800";default:return"bg-yellow-100 text-yellow-800"}};return r?e.jsx("p",{className:"text-gray-500",children:"Loading orders..."}):e.jsxs("div",{className:"bg-white shadow-md rounded-xl p-6 max-w-4xl mx-auto",children:[e.jsx("h2",{className:"text-2xl font-bold text-primary mb-4",children:"My Orders"}),0===t.length?e.jsx("p",{className:"text-gray-600",children:"No orders found."}):e.jsx("div",{className:"space-y-8",children:t.map(s=>{const t=s.items.reduce((e,t)=>{var a,r;const l=(null==(a=t.labId)?void 0:a._id)||t.labId,n=(null==(r=t.labId)?void 0:r.name)||"Unknown Lab";return e[l]||(e[l]={labName:n,items:[],subtotal:0,status:t.status||s.status}),e[l].items.push(t),e[l].subtotal+=t.price,e},{});return e.jsxs("div",{className:"border rounded-lg shadow-md p-4 space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h3",{className:"font-semibold text-lg",children:["Order ID: ",s._id]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("span",{className:"text-sm text-gray-500",children:["Payment: ",s.paymentStatus]})})]}),Object.entries(t).map(([t,a])=>e.jsxs("div",{className:"border rounded p-3 bg-gray-50",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h4",{className:"font-semibold",children:a.labName}),e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${d(a.status)}`,children:a.status})]}),e.jsx("ul",{className:"text-sm divide-y",children:a.items.map((s,t)=>e.jsxs("li",{className:"flex justify-between py-1",children:[e.jsx("span",{children:s.name}),e.jsx("span",{children:"1x"}),e.jsxs("span",{children:[" $ ",s.price]})]},t))}),e.jsxs("div",{className:"text-right mt-2 text-sm font-semibold",children:["Subtotal for this lab: $ ",a.subtotal]}),"Pending"===a.status&&e.jsx("div",{className:"mt-2 text-right",children:e.jsx("button",{className:"text-red-600 hover:underline text-sm",onClick:async()=>{if(window.confirm("Cancel this lab's order?")){(await fetch(`/api/orders/${s._id}/cancel/${t}`,{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}})).ok&&await n()}},children:"Cancel Lab Order"})})]},t)),e.jsxs("div",{className:"text-right text-sm font-semibold",children:["Total Order: $ ",s.subtotal," | Delivery: $ ",s.deliveryCharge," ",e.jsx("br",{}),e.jsxs("span",{className:"text-base",children:["Final Total: $ ",s.subtotal+s.deliveryCharge]})]})]},s._id)})})]})};export{t as default};
